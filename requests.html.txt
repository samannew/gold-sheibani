<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>مدیریت درخواست‌ها</title>
    <style>
        body { font-family: Arial; text-align: center; background: #f4f4f4; }
        table { width: 80%; margin: 20px auto; border-collapse: collapse; background: white; border-radius: 8px; }
        th, td { border: 1px solid #ccc; padding: 10px; text-align: center; }
        th { background: #007bff; color: white; }
        button { padding: 8px 16px; margin: 2px; background: #28a745; color: white; border: none; border-radius: 4px; cursor: pointer; }
        button.reject { background: #dc3545; }
        button:hover { opacity: 0.8; }
    </style>
</head>
<body>
    <h2>مدیریت درخواست‌ها</h2>
    <table>
        <tr><th>کاربر</th><th>نوع</th><th>کالا</th><th>مقدار</th><th>قیمت</th><th>عملیات</th></tr>
        {% for req in requests %}
            <tr>
                <td>{{ req.user }}</td><td>{{ req.type }}</td><td>{{ req.item }}</td><td>{{ req.quantity|round(2) }}</td><td>{{ req.price|int }}</td>
                <td>
                    <button onclick="requestAction({{ req.id }}, 'approve')">تأیید</button>
                    <button class="reject" onclick="requestAction({{ req.id }}, 'reject')">رد</button>
                </td>
            </tr>
        {% endfor %}
    </table>
    <button onclick="window.location='/admin'">بازگشت</button>
    <script>
        function requestAction(id, action) {
            fetch(`/request_action/${id}/${action}`)
                .then(response => response.json())
                .then(data => alert(data.message))
                .then(() => window.location.reload());
        }
    </script>
</body>
</html>